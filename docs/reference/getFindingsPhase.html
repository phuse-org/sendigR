<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Returns a data table with the set of findings rows included in the
findings of the phase(s) specified in the phaseFilter.
If the phaseFilter is empty (null, na or empty string), all rows from
findings are returned with the an additional PHASE column."><title>Extract a set of findings for a specified study phase - or just add phase
for each animal. — getFindingsPhase • sendigR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract a set of findings for a specified study phase - or just add phase
for each animal. — getFindingsPhase"><meta property="og:description" content="Returns a data table with the set of findings rows included in the
findings of the phase(s) specified in the phaseFilter.
If the phaseFilter is empty (null, na or empty string), all rows from
findings are returned with the an additional PHASE column."><meta property="og:image" content="https://phuse-org.github.io/sendigR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sendigR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Introduction.html">Introduction to sendigR</a>
    <a class="dropdown-item" href="../articles/SendDashboard.html">SendDashboard</a>
    <a class="dropdown-item" href="../articles/Usingxptcleaner.html">Using xptcleaner</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/phuse-org/sendigR/wiki/Resources">Resources</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/phuse-org/sendigR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extract a set of findings for a specified study phase - or just add phase
for each animal.</h1>
      <small class="dont-index">Source: <a href="https://github.com/phuse-org/sendigR/blob/HEAD/R/getFindingsPhase.R" class="external-link"><code>R/getFindingsPhase.R</code></a></small>
      <div class="d-none name"><code>getFindingsPhase.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Returns a data table with the set of findings rows included in the
<code>findings</code> of the phase(s) specified in the <code>phaseFilter</code>.<br>
If the <code>phaseFilter</code> is empty (null, na or empty string), all rows from
<code>findings</code> are returned with the an additional PHASE column.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">getFindingsPhase</span><span class="op">(</span>
  <span class="va">dbToken</span>,
  <span class="va">findings</span>,
  phaseFilter <span class="op">=</span> <span class="cn">NULL</span>,
  inclUncertain <span class="op">=</span> <span class="cn">FALSE</span>,
  noFilterReportUncertain <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dbToken</dt>
<dd><p>Mandatory<br>
Token for the open database connection (see <code><a href="initEnvironment.html">initEnvironment</a></code>).</p></dd>
<dt>findings</dt>
<dd><p>Mandatory, data.table.<br>
A data.table with the set of finding rows to process.<br>
The table must include at least columns named</p><ul><li><p>STUDYID</p></li>
<li><p>USUBJID</p></li>
<li><p>DOMAIN</p></li>
<li><p>domainSEQ</p></li>
<li><p>domainDTC</p></li>
</ul><p>where domain is the name of the actual findings domain - e.g. LBSEQ and
LBDTC</p></dd>
<dt>phaseFilter</dt>
<dd><p>Optional, character.<br>
The phase value criterion to be used for filtering of the list of animals.<br>
It can be a single string, a vector or a list of multiple strings.</p></dd>
<dt>inclUncertain</dt>
<dd><p>Mandatory, boolean.<br>
Only relevant if the <code>phaseFilter</code> is not empty.<br>
Indicates whether finding rows for which the phase cannot be confidently
identified shall be included or not in the output data table.</p></dd>
<dt>noFilterReportUncertain</dt>
<dd><p>Mandatory, boolean.<br>
Only relevant if the <code>phaseFilter</code> is empty.<br>
Indicates if the reason should be included if the phase cannot be
confidently decided for an animal.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns a data.table with columns in this order:</p><ul><li><p>All columns contained in the <code>findings</code> input table (original
order except optional UNCERTAIN_MSG and NOT_VALID_MSG)</p></li>
<li><p>PHASE          (character)</p></li>
<li><p>UNCERTAIN_MSG  (character)<br>
Included when parameter <code>inclUncertain=TRUE</code>.<br>
In case the phase cannot be confidently matched during the
filtering of data, the column contains an indication of the reason.<br>
If any uncertainties have been identified for individual subjects included in
pools for pooled finding rows, all messages for subjects per pool/findings
are merged together and reported as one message per pool/finding.<br>
Is NA for rows where phase can be confidently matched.<br>
A non-empty UNCERTAIN_MSG value generated by this function is merged with
non-empty UNCERTAIN_MSG values which may exist in the input set of findings
specified in <code>findings</code> - separated by '|'.</p></li>
<li><p>NOT_VALID_MSG (character)<br>
Included when parameter <code>noFilterReportUncertain=TRUE</code>.<br>
In case the phase cannot be confidently decided, the column
contains an indication of the reason.<br>
Is NA for rows where phase can be confidently decided.<br>
A non-empty NOT_VALID_MSG value generated by this function is merged with
non-empty NOT_VALID_MSG values which may exist in the input set of findings
<code>findings</code> - separated by '|'.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The logic for the extraction is based on the subject elements and the trial
design domains - for each finding row:</p><ul><li><p>The related subject element is found in SE as the row where the
value of domainDTC is within the interval from SESTDTC to SEENDTC</p></li>
<li><p>The actual EPOCH is found in TA in the row matching the found
element (via the ETCD value)</p></li>
<li><p>The actual study phase is derived from the EPOCH value matching at
set of text patterns</p></li>
</ul><p>For pooled findings rows - i.e. POOLID is populated instead of USUBJID - the
phase is identified per animal included in the each pool and finding, and if all
identified phases are equal per pool and finding, the identified phase are
returned per pool and finding.</p>
<p>The populated value of a phase is one of:</p><ul><li><p>'Screening'<br>
If TA.EPOCH fulfills one:</p><ul><li><p>contains 'pre' followed by one of
['treat','trt','dos',test','study','exposure']</p></li>
<li><p>contains one of
['acclimat','screen','baseline','allocat','random']</p></li>
</ul></li>
<li><p>'Recovery'<br>
If TA.EPOCH doesn't fulfill the pattern for 'Screening' and fulfills one
of:</p><ul><li><p>contains 'recovery'</p></li>
<li><p>contains 'post' followed by one of
['treat','trt','dos','test','study','exposure']</p></li>
</ul></li>
<li><p>'Treatment'<br>
If TA.EPOCH doesn't fulfill the patterns for 'Screening' or 'Recovery'
and fulfills both:</p><ul><li><p>contains one of
['treat','trt','dos','test','exposure']</p></li>
<li><p>does not contain any of
['off','non'|','free'|','holiday']</p></li>
</ul></li>
<li><p>'Uncertain'<br>
If the TA.EPOCH is empty or does not fulfills any of the requirements
described for the three phases above.</p></li>
</ul><p>If input parameter <code>inclUncertain=TRUE</code>, findings rows where the phase
cannot be confidently identified are included in the output set. These
uncertain situations are identified and reported (in column UNCERTAIN_MSG):</p><ul><li><p>One of the date/time values SESTDTC, SEENDTC or domainDTC is empty
or contains an invalid ISO 8601 value</p></li>
<li><p>The value of domainDTC is included in more then one SESTDTC/SEENDTC
interval</p></li>
<li><p>The EPOCH value does not match any of the patterns identifying the
set of possible study phases.</p></li>
<li><p>Different phases have been identified for individual subjects in a
pool for a given finding</p></li>
</ul><p>The same checks are performed and reported in column NOT_VALID_MSG if
<code>phaseFilter</code> is empty and <code>noFilterReportUncertain=TRUE</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># Extract LB rows for the Treatment phase - include uncertain rows</span></span>
<span class="r-in"><span class="fu">getFindingsPhase</span><span class="op">(</span><span class="va">dbToken</span>, <span class="va">lb</span>,</span>
<span class="r-in">                 phaseFilter <span class="op">=</span> <span class="st">'Treatment'</span>,</span>
<span class="r-in">                 inclUncertain <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># No filtering, just add PHASE to FW rows - do not include messages when</span></span>
<span class="r-in"><span class="co"># the phase cannot be confidently identified</span></span>
<span class="r-in"><span class="fu">getFindingsPhase</span><span class="op">(</span><span class="va">dbToken</span>, <span class="va">fw</span>,</span>
<span class="r-in">                 noFilterReportUncertain <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Bo Larsen, Yousuf Ali, Kevin Snyder, William Houser, Brianna Paisley, Cmsabbir Ahmed, Susan Butler, Michael Rosentreter, Michael Denieu, Wenxian Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

